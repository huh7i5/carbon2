<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高德地图测试</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #1a252f;
            color: white;
        }
        
        #mapContainer {
            width: 100%;
            height: 500px;
            border: 1px solid #333;
            border-radius: 8px;
        }
        
        .status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 4px;
        }
        
        .status.loading {
            background: rgba(255, 193, 7, 0.1);
            color: #ffc107;
        }
        
        .status.success {
            background: rgba(0, 212, 170, 0.1);
            color: #00d4aa;
        }
        
        .status.error {
            background: rgba(255, 107, 107, 0.1);
            color: #ff6b6b;
        }
        
        .info {
            margin: 10px 0;
            font-size: 14px;
            color: #a0a0a0;
        }
    </style>
</head>
<body>
    <h1>沪碳智脑 - 高德地图测试</h1>
    
    <div id="status" class="status loading">
        正在加载高德地图API...
    </div>
    
    <div class="info">
        <strong>API Key:</strong> ec8bd2f50328bddc6a67a4e881f4adfb<br>
        <strong>Security Code:</strong> 6048d86b12ebfa706956ecda48abae64<br>
        <strong>中心点:</strong> [121.783333, 30.866667] (上海化学工业区)
    </div>
    
    <div id="mapContainer"></div>
    
    <!-- 高德地图API安全密钥配置 -->
    <script type="text/javascript">
        window._AMapSecurityConfig = {
            securityJsCode: "6048d86b12ebfa706956ecda48abae64",
        };
    </script>
    
    <!-- 高德地图API Loader -->
    <script src="https://webapi.amap.com/loader.js"></script>
    
    <script>
        const statusEl = document.getElementById('status');
        
        function updateStatus(message, type) {
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
        }
        
        async function initMap() {
            try {
                updateStatus('加载高德地图API...', 'loading');
                
                // 使用AMapLoader加载高德地图API
                const AMap = await AMapLoader.load({
                    key: "ec8bd2f50328bddc6a67a4e881f4adfb",
                    version: "2.0",
                    plugins: ['AMap.Scale', 'AMap.ToolBar']
                });
                
                updateStatus('初始化地图实例...', 'loading');
                
                // 初始化地图实例
                const map = new AMap.Map('mapContainer', {
                    center: [121.783333, 30.866667],
                    zoom: 12,
                    mapStyle: 'amap://styles/darkblue',
                    viewMode: '2D'
                });
                
                // 添加控件
                map.addControl(new AMap.Scale());
                map.addControl(new AMap.ToolBar());
                
                // 添加标记点
                const marker = new AMap.Marker({
                    position: [121.783333, 30.866667],
                    title: '上海化学工业区CO2捕集源'
                });
                
                marker.setMap(map);
                
                // 地图加载完成监听
                map.on('complete', () => {
                    updateStatus('地图加载成功！点击标记查看信息', 'success');
                });
                
                console.log('地图初始化成功');
                
            } catch (error) {
                console.error('地图初始化失败:', error);
                updateStatus(`地图加载失败: ${error.message}`, 'error');
            }
        }
        
        // 页面加载完成后初始化地图
        document.addEventListener('DOMContentLoaded', initMap);
    </script>
</body>
</html>